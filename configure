#!/bin/sh
set -e

UNAME_S=`uname -s 2>/dev/null || echo unknown`

STRIP_FLAGS=""
case "$UNAME_S" in
  Darwin)
    STRIP_FLAGS="-Wl,-dead_strip"
    ;;
  Linux)
    STRIP_FLAGS="-Wl,--gc-sections"
    ;;
esac

# Generate src/Makevars from template
sed -e "s|@STRIP_FLAGS@|$STRIP_FLAGS|g" \
  src/Makevars.in > src/Makevars

exit 0
