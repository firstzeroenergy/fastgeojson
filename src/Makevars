# src/Makevars (Linux / macOS)

TARGET_DIR = rust/target
LIBDIR     = $(TARGET_DIR)/release
STATLIB    = $(LIBDIR)/libfastgeojson.a

PKG_LIBS   = -L$(LIBDIR) -lfastgeojson

all: $(SHLIB)

$(SHLIB): $(STATLIB)

$(STATLIB):
	# CRAN requirement: print compiler versions
	rustc --version
	cargo --version

	RUSTFLAGS="$(RUSTFLAGS)" \
	cargo build --release --lib \
	  --manifest-path=rust/Cargo.toml \
	  --target-dir $(TARGET_DIR)

clean:
	rm -f $(SHLIB) $(OBJECTS)
	rm -rf $(TARGET_DIR)
